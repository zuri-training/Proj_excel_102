{"version":3,"file":"static/js/867.11d71d14.chunk.js","mappings":"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","sources":["pages/operations/SearchReplace.js"],"sourcesContent":["import { useSelector, useDispatch } from \"react-redux\";\r\n\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\n\r\nimport $ from \"jquery\";\r\n\r\nimport { user_actions } from \"../../store\";\r\n\r\nimport DashboardSidebar from \"../../components/DashboardSidebar\";\r\nimport DashboardHeader from \"../../components/DashboardHeader\";\r\nimport DashboardFooter from \"../../components/DashboardFooter\";\r\n\r\nconst SearchReplace = () => {\r\n    const { operation_id } = useParams();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const api_base_url = useSelector((state) => state.app_data.api_base_url);\r\n    const access_token = useSelector((state) => state.user.access_token);\r\n\r\n    const base_url = useSelector((state) => state.app_data.base_url);\r\n    const user_id = useSelector((state) => state.user.user_info.id);\r\n\r\n    const [loading, set_loading] = useState(true);\r\n    const [operation_info, set_operation_info] = useState(\"\");\r\n\r\n    const rn_btn = useRef();\r\n\r\n    const [rn_modal_open, set_rn_modal_open] = useState(false);\r\n    const [rn_file_id, set_rn_file_id] = useState(null);\r\n    const [new_filename, set_new_filename] = useState(\"\");\r\n    const [rename_server_response, set_rename_server_response] = useState(\"\");\r\n\r\n    const doRenameFile = (e) => {\r\n        e.preventDefault();\r\n\r\n        rn_btn.current.innerHTML = `<span class=\"fas fa-spinner fa-spin\"></span> Renaming file`;\r\n\r\n        $.ajax({\r\n            type: \"PATCH\",\r\n            url: `${api_base_url}/files/${rn_file_id}?new_filename=${new_filename}`,\r\n            headers: {\r\n                Authorization: `Bearer ${access_token}`,\r\n            },\r\n            success: function () {\r\n                window.location.reload();\r\n            },\r\n            statusCode: {\r\n                406: function ({ responseJSON: response }) {\r\n                    set_rename_server_response(response.message);\r\n                    rn_btn.current.innerHTML = \"Rename\";\r\n                },\r\n            },\r\n        });\r\n\r\n        e.stopPropagation();\r\n    };\r\n\r\n    const renameFile = (file_id, filename) => {\r\n        set_rn_file_id(file_id);\r\n        set_new_filename(filename);\r\n        set_rn_modal_open(true);\r\n    };\r\n\r\n    const closeRenameFile = () => {\r\n        set_rn_modal_open(false);\r\n        set_rn_file_id(null);\r\n        set_new_filename(\"\");\r\n    };\r\n\r\n    useEffect(() => {\r\n        $.ajax({\r\n            type: \"GET\",\r\n            url: `${api_base_url}/operations/search_replace/${operation_id}`,\r\n            headers: {\r\n                Authorization: `Bearer ${access_token}`,\r\n            },\r\n            success: function (response) {\r\n                set_operation_info(response.data);\r\n                set_loading(false);\r\n            },\r\n            statusCode: {\r\n                401: function () {\r\n                    dispatch(user_actions.logout());\r\n                },\r\n                404: function () {\r\n                    set_loading(false);\r\n                },\r\n            },\r\n        });\r\n    }, [access_token, api_base_url, dispatch, operation_id]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"preloader\">\r\n                <span className=\"fas fa-spinner fa-spin\"></span> Fetching file\r\n                contents\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!operation_info) {\r\n        return <div className=\"preloader\">Error fetching file</div>;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {rn_modal_open && (\r\n                <div className={`modal modal-open`}>\r\n                    <div className=\"modal-header\">\r\n                        Rename File{\" \"}\r\n                        <span onClick={closeRenameFile}>&times;</span>\r\n                    </div>\r\n                    <form onSubmit={doRenameFile}>\r\n                        <div\r\n                            className=\"modal-body\"\r\n                            style={{ textAlign: \"left\" }}\r\n                        >\r\n                            <label className=\"modal-label\">New name</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"modal-input\"\r\n                                placeholder=\"Enter new file name\"\r\n                                value={new_filename}\r\n                                onChange={(e) =>\r\n                                    set_new_filename(e.target.value)\r\n                                }\r\n                            />\r\n                        </div>\r\n                        <div\r\n                            className=\"modal-footer\"\r\n                            style={{ textAlign: \"right\" }}\r\n                        >\r\n                            {rename_server_response}&nbsp;&nbsp;&nbsp;&nbsp;\r\n                            <button className=\"modal-btn\" ref={rn_btn}>\r\n                                Rename\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            )}\r\n            <main className=\"dashboard-container\">\r\n                <DashboardSidebar />\r\n                <div className=\"dashboard-content\">\r\n                    <DashboardHeader />\r\n                    <section className=\"dashboard-main\">\r\n                        <div className=\"dashboard-breadcrumb\">\r\n                            <div className=\"dashboard-breadcrumb-left\">\r\n                                <h3 className=\"dashboard-breadcrumb-title\">\r\n                                    Search and Replace\r\n                                </h3>\r\n                                <p className=\"dashboard-breadcrumb-text\">\r\n                                    A search and replace operation performed by\r\n                                    you\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"dashboard-breadcrumb-right\"></div>\r\n                        </div>\r\n                        <div className=\"files-preview mb-3\">\r\n                            <div className=\"file\">\r\n                                <div className=\"file-header\">\r\n                                    <h3 className=\"file-name\">\r\n                                        {operation_info.file_details.file_name}\r\n                                    </h3>\r\n                                    <div className=\"file-action-btns\">\r\n                                        <button\r\n                                            className=\"change-file-btn\"\r\n                                            onClick={() =>\r\n                                                renameFile(\r\n                                                    operation_info.file_details\r\n                                                        .id,\r\n                                                    operation_info.file_details\r\n                                                        .file_name\r\n                                                )\r\n                                            }\r\n                                        >\r\n                                            Rename\r\n                                        </button>\r\n                                        <a\r\n                                            href={`${base_url}dc/${user_id}/${operation_info.file_details.file_name}`}\r\n                                            target=\"_new\"\r\n                                            className=\"change-file-btn\"\r\n                                        >\r\n                                            Download\r\n                                        </a>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"file-preview-box\">\r\n                                    <table className=\"file-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                {operation_info.file_details.file_content[0].map(\r\n                                                    (cell, i) => {\r\n                                                        return (\r\n                                                            <th\r\n                                                                key={i}\r\n                                                                style={{\r\n                                                                    backgroundColor: `#${cell.background}`,\r\n                                                                }}\r\n                                                            >\r\n                                                                {cell.value}\r\n                                                            </th>\r\n                                                        );\r\n                                                    }\r\n                                                )}\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {operation_info.file_details.file_content\r\n                                                .slice(1)\r\n                                                .map((row, i) => {\r\n                                                    return (\r\n                                                        <tr key={i}>\r\n                                                            {row.map(\r\n                                                                (cell, j) => {\r\n                                                                    return (\r\n                                                                        <td\r\n                                                                            key={\r\n                                                                                j\r\n                                                                            }\r\n                                                                            style={{\r\n                                                                                backgroundColor: `#${cell.background}`,\r\n                                                                            }}\r\n                                                                        >\r\n                                                                            {\r\n                                                                                cell.value\r\n                                                                            }\r\n                                                                        </td>\r\n                                                                    );\r\n                                                                }\r\n                                                            )}\r\n                                                        </tr>\r\n                                                    );\r\n                                                })}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"files-preview\">\r\n                            <div className=\"file\">\r\n                                <div className=\"file-header\">\r\n                                    <h3 className=\"file-name\">\r\n                                        {\r\n                                            operation_info.replaced_file_details\r\n                                                .file_name\r\n                                        }\r\n                                    </h3>\r\n                                    <div className=\"file-action-btns\">\r\n                                        <button\r\n                                            className=\"change-file-btn\"\r\n                                            onClick={() =>\r\n                                                renameFile(\r\n                                                    operation_info\r\n                                                        .replaced_file_details\r\n                                                        .id,\r\n                                                    operation_info\r\n                                                        .replaced_file_details\r\n                                                        .file_name\r\n                                                )\r\n                                            }\r\n                                        >\r\n                                            Rename\r\n                                        </button>\r\n                                        <a\r\n                                            href={`${base_url}dc/${user_id}/${operation_info.replaced_file_details.file_name}`}\r\n                                            target=\"_new\"\r\n                                            className=\"change-file-btn\"\r\n                                        >\r\n                                            Download\r\n                                        </a>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"file-preview-box\">\r\n                                    <table className=\"file-table\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                {operation_info.replaced_file_details.file_content[0].map(\r\n                                                    (cell, i) => {\r\n                                                        return (\r\n                                                            <th\r\n                                                                key={i}\r\n                                                                style={{\r\n                                                                    backgroundColor: `#${cell.background}`,\r\n                                                                }}\r\n                                                            >\r\n                                                                {cell.value}\r\n                                                            </th>\r\n                                                        );\r\n                                                    }\r\n                                                )}\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {operation_info.replaced_file_details.file_content\r\n                                                .slice(1)\r\n                                                .map((row, i) => {\r\n                                                    return (\r\n                                                        <tr key={i}>\r\n                                                            {row.map(\r\n                                                                (cell, j) => {\r\n                                                                    return (\r\n                                                                        <td\r\n                                                                            key={\r\n                                                                                j\r\n                                                                            }\r\n                                                                            style={{\r\n                                                                                backgroundColor: `#${cell.background}`,\r\n                                                                            }}\r\n                                                                        >\r\n                                                                            {\r\n                                                                                cell.value\r\n                                                                            }\r\n                                                                        </td>\r\n                                                                    );\r\n                                                                }\r\n                                                            )}\r\n                                                        </tr>\r\n                                                    );\r\n                                                })}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </section>\r\n                    <DashboardFooter />\r\n                </div>\r\n            </main>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SearchReplace;\r\n"],"names":["operation_id","useParams","dispatch","useDispatch","api_base_url","useSelector","state","app_data","access_token","user","base_url","user_id","user_info","id","useState","loading","set_loading","operation_info","set_operation_info","rn_btn","useRef","rn_modal_open","set_rn_modal_open","rn_file_id","set_rn_file_id","new_filename","set_new_filename","rename_server_response","set_rename_server_response","renameFile","file_id","filename","useEffect","$","type","url","headers","Authorization","success","response","data","statusCode","user_actions","className","onClick","onSubmit","e","preventDefault","current","innerHTML","window","location","reload","responseJSON","message","stopPropagation","style","textAlign","placeholder","value","onChange","target","ref","file_details","file_name","href","file_content","map","cell","i","backgroundColor","background","slice","row","j","replaced_file_details"],"sourceRoot":""}